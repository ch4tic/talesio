---
import Layout from '~/layouts/PageLayout.astro';

import Hero from '~/components/widgets/Hero.astro';
import Testimonials from '~/components/widgets/Testimonials.astro';

import Stats from '~/components/widgets/Stats.astro';

const metadata = {
  title: 'Worldwide Banned Books | Talesio',
  ignoreTitleTemplate: true,
};

import Headline from '~/components/ui/Headline.astro';

const books = [
  { title: 'Magnetic Aura', page_url: 'https://takeshim.gumroad.com/l/magneticauraebook', img_url: '/MagneticAura.png' },
  { title: 'Arcane Stance', page_url: 'https://takeshim.gumroad.com/l/arcanestance', img_url: '/ArcaneStance.png' },
  { title: 'Suppressed Education', page_url: 'https://takeshim.gumroad.com/l/thesuppressededucation', img_url: '/TheSuppressedEducation.png' },
  { title: 'Energy Codes', page_url: 'https://revivalofwisdom.com/products/vibrational-energy-codes-pdf?sca_ref=7186286.vYxyAp6dwA', img_url: '/VibrationalEnergyCodes.png' },
  { title: 'Human Health Guide', page_url: 'https://revivalofwisdom.com/products/human-health-guide-pdf?sca_ref=7186286.vYxyAp6dwA', img_url: '/HumanHealthGuide.png' },
  { title: 'Book of Wisdom', page_url: 'https://revivalofwisdom.com/products/book-of-wisdom-pdf-english?sca_ref=7186286.vYxyAp6dwA', img_url: '/BookOfWisdom.png' },
  { title: 'Alkaline Awakening', page_url: 'https://revivalofwisdom.com/products/alkaline-awakening-book?sca_ref=7186286.vYxyAp6dwA', img_url: '/Alkaline.png' },
  { title: 'The Wisdom Bundle', page_url: 'https://revivalofwisdom.com/products/the-wisdom-bundle?sca_ref=7186286.vYxyAp6dwA', img_url: '/TheWisdomBundle.png' },
];
---

<Layout metadata={metadata}>
  <!-- Hero Widget ******************* -->

  <Hero
    actions={[
      {
        variant: 'primary',
        text: 'View Our Library',
        target: '_blank',
        icon: 'tabler:arrow-down',
        id: 'scroll-button',
      },
    ]}
  >
    <Fragment slot="title">
      <span class="text-accent dark:text-white highlight">Explore </span><span class="text-book-theme"
        > Banned</span> Books</span>
    </Fragment>

    <Fragment slot="subtitle">
      <span class="hidden sm:inline">
        <span class="font-semibold">Talesio</span><span> hosts a wide collection of banned books from around the world. <br>The site could be taken down any moment, hurry.</span>
    </Fragment>
  </Hero>

   <!-- Countdown Timer ******************* -->
   <div id="countdown" class="text-center py-8 text-white bg-red-600">
    <h2 class="text-3xl font-bold">DISCOUNT CODE: talesio20</h2>
    <p class="text-xl">The code will expire in:</p>
    <div id="timer" class="text-4xl font-bold mt-4"></div>
  </div>

  <!-- Stats Widget ****************** -->

  <Stats
    stats={[
      { title: 'Banned Books', amount: '3' },
      { title: 'Total Downloads', amount: '17.8K' },
      { title: 'Authors', amount: '2' },
    ]}
  />

  <div class="md:mx-auto w-full max-w-7xl py-12 md:py-20">
    <Headline title={'Forbidden Books Library'} />

    <div id="books-container" class="gap-8 w-full grid grid-cols-1 md:grid-cols-4 mb-5">
      {
        books.map((item) => (
          <div class="mx-auto md:mx-0 w-2/3 md:w-64  flex flex-col rounded-lg shadow-[0_4px_30px_rgba(0,0,0,0.1)] dark:shadow-[0_4px_30px_rgba(0,0,0,0.1)] backdrop-blur border border-[#ffffff29] bg-white dark:bg-slate-900 p-6 ">
            <a href={item.page_url}>
              <div>
                <img
                  class="mx-auto w-60 rounded-md"
                  style="aspect-ratio: 4 / 3;"
                  src={item.img_url}
                  alt={item.title}
                  sizes="(max-width: 600px) 100vw, (max-width: 900px) 50vw, 432px"
                  loading="lazy"
                />
              </div>
              <div class="text-center mt-4">
                <h3 class="text-lg font-semibold text-black dark:text-white">{item.title}</h3> <!-- Added title -->
              </div>
              <div>
                <a
                  href={item.page_url}
                  class="w-full mt-4 flex items-center justify-center border border-transparent text-base leading-6 rounded-md font-semibold text-white bg-book-theme hover:bg-book-hover focus:outline-none transition py-2 duration-300 ease-in-out md:py-1 md:text-lg md:px-10"
                >
                  Read Now
                </a>
              </div>
            </a>
          </div>
        ))
      }
    </div>
  </div>

<Testimonials
    title="What Others Are Saying..."
    testimonials={[
      {
        testimonial: `Talesio is a treasure trove of hidden knowledge. The books here challenge my worldview and have broadened my perspective.`,
        name: 'Anna Wright',
        job: 'Verified Reader',
        image: {
          img_url: '/Anonymous.jpeg',
          alt: 'Reader Anna Wright',
        },
      },
      {
        testimonial: `I've always been curious about banned books, and Talesio makes them accessible. These titles are unlike anything youâ€™ll find in mainstream libraries.`,
        name: 'Laura Mitchell',
        job: 'Verified Reader',
        image: {
          img_url: '/Anonymous.jpeg',
          alt: 'Reader Laura Mitchell',
        },
      },
      {
        testimonial: `Talesio offers a unique and important collection. Reading these works has given me a fresh perspective on global issues.`,
        name: 'David Parker',
        job: 'Verified Reader',
        image: {
          img_url: '/Anonymous.jpeg',
          alt: 'Reader David Parker',
        },
      },
    ]}
    
    callToAction={{
      target: '_blank',
      text: 'More reviews...',
      href: 'https://github.com/onwidget/astrowind',
      icon: 'tabler:chevron-right',
    }}
  />

</Layout>

<script>
  document.getElementById('scroll-button').addEventListener('click', function () {
    document.getElementById('books-container').scrollIntoView({ behavior: 'smooth' });
  });
</script>

<script>
  // Persistent Countdown Timer Script for 13 hours
  function countdown() {
    const timerDisplay = document.getElementById('timer');
    const now = new Date().getTime();

    // Check if the 'endTime' is already stored in localStorage
    let endTime = localStorage.getItem('endTime');

    // If there's no 'endTime' in localStorage, set it to 13 hours from now
    if (!endTime) {
      endTime = now + (12 * 60 * 60 * 1000); // 13 hours from now
      localStorage.setItem('endTime', endTime);
    }

    // Convert the stored string back into a number
    endTime = parseInt(endTime, 10);

    const interval = setInterval(() => {
      const currentTime = new Date().getTime();
      const distance = endTime - currentTime;

      // If the countdown is over, clear the interval and display "Time's up!"
      if (distance < 0) {
        clearInterval(interval);
        timerDisplay.innerHTML = "Time's up!";
        localStorage.removeItem('endTime'); // Optionally clear the end time from localStorage
        return;
      }

      // Calculate hours, minutes, and seconds remaining
      const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((distance % (1000 * 60)) / 1000);

      // Display the countdown
      timerDisplay.innerHTML = `${hours}h ${minutes}m ${seconds}s`;
    }, 1000);
  }

  countdown();
</script>